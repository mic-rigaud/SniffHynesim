\documentclass[a4paper, 11pt, oneside, oldfontcommands]{memoir}

%%%%% Packages %%%%%
\usepackage{lmodern}
\usepackage{palatino}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}


%%%%%%%%%%%%%%%%%%%%  PACKAGE SECONDAIRE

%\usepackage{amstext,amsmath,amssymb,amsfonts} % package math
%\usepackage{multirow,colortbl}	% to use multirow and ?
%\usepackage{xspace,varioref}
\usepackage[linktoc=all, hidelinks]{hyperref}			% permet d'utiliser les liens hyper textes
\usepackage{float}				% permet d ajouter d autre fonction au floatant
%\usepackage{wrapfig}			% permet d avoir des image avec texte coulant a cote
%\usepackage{fancyhdr}			% permet d inserer des choses en haut et en bas de chaque page
\usepackage{microtype}			% permet d ameliorer l apparence du texte
%\usepackage[explicit]{titlesec}	% permet de modifier les titres
\usepackage{graphicx}			% permet d utiliser les graphiques
\graphicspath{{./images/}}		% to say where are image
%\usepackage{eso-pic} 			% to put figure in the background
\usepackage[svgnames]{xcolor}	% permet d avoir plus de 300 couleur predefini
%\usepackage{array}				% permet d ajouter des option dans les tableaux
\usepackage{listings}			% permet d ajouter des ligne de code
%\usepackage{tikz}				% to draw figure
%\usepackage{appendix}			% permet de faire les index
%\usepackage{makeidx}			% permet de creer les index
%\usepackage{fancyvrb}			% to use Verbatim
%\usepackage{framed}				% permet de faire des environnement cadre
%\usepackage{fancybox}			% permet de realiser les cadres
\usepackage{titletoc}			% permet de modifier les titres
%\usepackage{caption}
\usepackage[a4paper, top=2cm, bottom=2cm]{geometry}
\usepackage{frbib}                      %permet d avoir une biblio francaise
\usepackage[babel=true]{csquotes}
\usepackage{enumitem}


\RequirePackage{pageGardeEnsta}	% permet d avoir la page de garde ensta

\setcounter{secnumdepth}{2}		% permet d'augmenter la numerotation
%\setcounter{tocdepth}{2}		% permet d'augmenter la numerotation

%%%%%%%%%%%%%%%%%%  DEFINITION DES BOITES
\newcounter{rem}[chapter]

\newcommand{\remarque}[1]{\stepcounter{rem}\noindent\fcolorbox{OliveDrab}{white}{\parbox{\textwidth}{\textcolor{OliveDrab}{
\textbf{Remarque~\thechapter.\therem~:}}\\#1}}}

\newcounter{th}[chapter]

\newcommand{\theoreme}[2]{\noindent\fcolorbox{FireBrick}{white}{\stepcounter{th}
\parbox{\textwidth}{\textbf{\textcolor{FireBrick}{Théorème~\thechapter.\theth~:}}{\hfill \textit{#1}}\\#2}}}

\newcommand{\attention}[1]{\noindent\fcolorbox{white}{white}{\parbox{\textwidth}{\textcolor{FireBrick}{
        \textbf{Attention !}}\\\textit{#1}\\}}}


\newcommand{\definition}[2]{\noindent\fcolorbox{OliveDrab}{white}{\stepcounter{th}
    \parbox{\textwidth}{\textbf{\textcolor{OliveDrab}{Definition~\thechapter.\theth~:}}{~
        \textit{#1}}~\setlength{\parindent}{15pt}\par#2\par}}\par~\\}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\lstdefinelanguage{suricata}
{morekeywords= {alert, tcp, http, tls, ip, ipv4, ipv4, drop, pass, sid, priority, rev, classtype, threshold, metadata, reference, tag, msg, content, uricontent, pcre, ack, seq, depth, distance, within, offset, replace, nocase, fast\_pattern, rawbytes, byte\_test, byte\_jump, sameip, ip\_proto, flow, window, ftpbounce, isdataat, id, rpc, dsize, flowvar, flowint, pktvar, noalert, flowbits, stream\_size, ttl, itype, icode, tos, icmp\_id, icmp\_seq, detection\_filter, ipopts, flags, fragbits, fragoffset, gid, nfq\_set\_mark, tls.version, tls.subject, tls.issuerdn, tls.fingerprint, tls.store, http\_cookie, http\_method, urilen, http\_client\_body, http\_server\_body, http\_header, http\_raw\_header, http\_uri, http\_raw\_uri, http\_stat\_msg, http\_stat\_code, http\_user\_agent, ssh.protoversion, ssh.softwareversion, ssl\_version, ssl\_state, byte\_extract, file\_data, dce\_iface, dce\_opnum, dce\_stub\_data, asn1, filename, fileext, filestore, filemagic, filemd5, filesize, l3\_proto, luajit},
otherkeywords={ipv4-csum, tcpv4-csum, tcpv6-csum, udpv4-csum, udpv6-csum, icmpv4-csum, icmpv6-csum, decode-event, app-layer-event, engine-event, stream-event},
sensitive=true,
morecomment=[l]{//},
morecomment=[s]{/*}{*/},
morestring=\color{blue}[b]",
keywordstyle=\bfseries\color{red!70!black},
}


%% INDEX %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeindex

%%%%% Useful macros %%%%%
\newcommand{\latinloc}[1]{\ifx\undefined\lncs\relax\emph{#1}\else\textrm{#1}\fi\xspace}
\newcommand{\etc}{\latinloc{etc}}
\newcommand{\eg}{\latinloc{e.g.}}
\newcommand{\ie}{\latinloc{i.e.}}
\newcommand{\cad}{c'est-à-dire }
\newcommand{\st}{\ensuremath{\text{\xspace s.t.\xspace}}}

%%%% Definition des couleur %%%%

\newcommand\couleurb[1]{\textcolor{SteelBlue}{#1}}
\newcommand\couleurr[1]{\textcolor{DarkRed}{#1}}


%% number page style style %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagestyle{plain}
%\pagestyle{empty}
%\pagestyle{headings}
%\pagestyle{myheadings}



%% chapters style %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% You may try several styles (see more in the memoir manual).

%\chapterstyle{veelo}
%\chapterstyle{chappell}
%\chapterstyle{ell}
%\chapterstyle{ger}
%\chapterstyle{pedersen}
%\chapterstyle{verville}
\chapterstyle{madsen}
%\chapterstyle{thatcher}


%%%%% Report Title %%%%%
\title{Sniff Hynesim}
\author{\textsc{Rigaud Michaël}}
\date{\today}
\doctype{Report}
\promo{promo 2017}
\etablissement{\textsc{Ensta} Bretagne\\2, rue François Verny\\
  29806 \textsc{Brest} cedex\\\textsc{France}\\Tel +33 (0)2 98 34 88 00\\ \url{www.ensta-bretagne.fr}}
\logoEcole{\includegraphics[height=4.2cm]{logo_ENSTA_Bretagne_Vertical_CMJN}}



%%%%%%%%%%%%%%%%%% DEBUT DU DOCUMENT
\begin{document}

\maketitle
\thispagestyle{empty}
\newpage

\tableofcontents



\chapter*{Abstract}
\addcontentsline{toc}{chapter}{Abstract}


This project consist in elaborate the cyber defense of a system virtualize on Hynesim. I had to detect all attacks
against my system. During this project, Justin Bouroux achieve attacks. The project try to know the state of the
system and analyze it with model to know if there is an attack.


%%%%%%%%%%%%%%%%% INTRODUCTION

\chapter*{Introduction}
\addcontentsline{toc}{chapter}{Introduction}

Cyber security is one of the major threats of the 21st century, and attackers use increasingly sophisticated
techniques. So one of the most important aims for cyber security engineers is to find a way to detect and stop
attacks. To do that effectively cyber engineers need to analyze cyber attacks to find a way to detect them. One
solution is to use simulators of network and information systems to reproduce scenario of attacks. Simulators
permit to achieve attacks in a closed space with a huge agility. To do so, ENSTA Bretagne has decided as Thales and
the DGA (French Procurement Agency) to use Hynesim\footnote{This software is presented in the chapter
  \ref{chap:hynesim}}.

The aim of this project is to elaborate a system of alert on Hynesim. This system need to analyze network events
and applications events. To do that, I have to install an IDS\footnote{Intrusion detection system} to analyze
network traffic and implement an SIEM\footnote{Security information and event management} to aggregate alerts.
Then, with all these events the SIEM may establish the state of the system. If we consider that we are able to know
all possible states of systems via model checking, the SIEM may know if the system is on a attacked state.

To begin, I will achieve a bibliographic study which will present Hynesim, IDS and SIEM. Then, I am going to
present the subject, the choices made to answer the topic, and the organization set up in this project. And to
finish, I will explain how I installed the tools available to me, how I achieved the other tools that I needed, and
the results of the project.

\newpage
%%%%%%%%%%%%%%%%%%%%%%%%


\part{Bibliographic study}
  \input{Partie/Hynesim}
  \input{Partie/IDS}
  \input{Partie/SIEM}

  \part{Presentation of the topic}
  \label{part:2}
  \input{Partie/Subject}
  \input{Partie/Choice}
  \input{Partie/Project}

\part{Technical study}
  \input{Partie/Install}
  \input{Partie/Implementation}
  \input{Partie/Analysis}



%%%% CONCLUSION %%%%%%%%%

\chapter*{Conclusion}
\addcontentsline{toc}{chapter}{Conclusion}


After this study, I got to implement a system of detection. But because of the lack of time, I achieved a simple
system, which is based on SELKS and on a SIEM implemented by me. This system is adapted to the application used for
the tests but it needs some improvements to be adapted for other applications.

We can also notice that my system of detection can also be attacked which has not been envisaged in this study.

To conclude, I achieve a simple system of detection which need some improvements. However, this system prove that
it is possible to retrieve all the states of an observed system. And if we could model this observed system, we
would be able to extract all the possible states of the system via model checking. Then, we could compare this
possible states with the current state of the system to detect attacks.

So it is a prove of contest of the possibility to use model checking to implement the security rules of an
application.




\newpage

%%%% ANNEXE %%%%%%%%%%%%

\part*{Annex}
\appendix
\nocite{*}
\input{Partie/Selks}
\newpage
 \listoffigures
 \printindex
 \bibliographystyle{plain}
  \bibliography{biblio}

\end{document}
%%%%%%%%%%%%%%%%% FIN DU DOCUMENT
%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
